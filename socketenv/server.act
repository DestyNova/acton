import stdenv

def log(s):
    print("<",s,">")

actor server(env):

    def session(conn):
  
        def echo(s):
            conn.write(s)
    
        def neterror(s):
            log("Net error: " + s)
            conn.close()
    
        log("Connected from " + conn.remoteHost)
        conn.on_receipt(input = echo,error = neterror)

    env.listen(12345,session)   # for now, port number hardwired
