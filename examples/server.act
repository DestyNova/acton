actor main(env):

    def stdout_w(conn,str):
        env.stdout_write(str)

    def echo(conn,b):
        env.stdout_write(b.decode())
        conn.write(b)
        
    def connect_handler(conn):
        print("Got a connection...")
        conn.on_receive(echo, stdout_w)

    def err_handler(sock):
        print("An error occurred trying to establish listening socket")
        env.exit(1)

    env.listen(12345, connect_handler, err_handler)
