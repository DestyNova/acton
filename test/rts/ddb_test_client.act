actor main(env):
    port = int(env.argv[1])

    def recv_handler(conn, msg):
        if msg == "0":
            print("Got a 0, doing noooothing...")

        if msg == "1":
            print("Got a 1, I'm happy, exiting...")
            await async env.exit(0)

    def connection_handler(conn):
        if conn is not None:
            print("Installing on_receive handler...")
            await async conn.on_receive(recv_handler, err_handler)
            conn.write("GET")

    def err_handler(conn, msg):
        print("Error with our connection occurred, attempting to re-establish connection")
        connect()

    def connect():
        env.connect("127.0.0.1", port, connection_handler)

    connect()
