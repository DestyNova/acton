import acton.rts
import time

actor Act(idx):
    def sleep():
        print(idx, "sleeping...")
        acton.rts.sleep(1)
        print(idx, "after sleep")
        return True

actor main(env):

    def test_async1():
        a1 = Act("1")
        print("-- async1 test start")
        t1 = time.time_ns()
        a1.sleep()
        t2 = time.time_ns()
        diff = (t2-t1) / 1000000000
        if diff > 0.1:
            print("a1.sleep() seemingly runs sync :/")
            await async env.exit(1)
        print("-- async1 test done")

    def test_async2():
        a1 = Act("1")
        print("-- async2 test start")
        t1 = time.time_ns()
        r = async a1.sleep()
        t2 = time.time_ns()
        diff = (t2-t1) / 1000000000
        if diff > 0.1:
            print("async a1.sleep() seemingly runs sync :/")
            await async env.exit(1)
        print("-- async2 test done")

    test_async1()
    test_async2()

    await async env.exit(0)
